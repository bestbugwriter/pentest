#!/usr/bin/python

import optparse, zipfile 
from threading import Thread

def extract_file(zfile, passwd):
	try:
		zfile.extractall(pwd=passwd)
		print "[+]zip file password is " + passwd
		return passwd
	except Exception, e:
		return

def main():
	parser = optparse.OptionParser("usage%prog " + "-f <zipfile> -d <dictionary>")
	parser.add_option('-f', dest="zname", type="string", help = "specify zip file")
	parser.add_option('-d', dest="dname", type="string", help = "specify dictionary file")
	(options, args) = parser.parse_args()
	if (options.zname == None) | (options.dname == None):
		print parser.usage
		exit(0)
	else:
		zname = options.zname
		dname = options.dname
	
	z = zipfile.ZipFile(zname)
	f = open(dname)

	for line in f.readlines():
		password = line.strip('\n')
		t = Thread(target=extract_file, args=(z,password))
		t.start()

if __name__ == "__main__":
	main()

